# Core-PPTAutomate

Automated PowerPoint presentation generation using a unified HTML-to-PPTX workflow.

## Architecture

The system uses a streamlined architecture inspired by claude-skills/pptx:

1. **Content Parsing**: Parse user conversations and data
2. **HTML Generation**: Generate HTML slides using LLM
3. **PPTX Conversion**: Convert HTML slides to PowerPoint using html2pptx

```
User Input → Content Parser → HTML Slide Generator → PPTX Converter → Output
```

## Key Features

- **Unified Workflow**: Single pipeline from content to presentation
- **HTML-First Approach**: Generate web-standard HTML slides
- **Design Principles**: Web-safe fonts, proper color contrast, responsive layouts
- **Chart Support**: Placeholder-based chart insertion
- **Source References**: Automatic reference slide generation

## Setup

### Python Dependencies

```bash
pip install -r requirements.txt
```

### Node.js Dependencies

The html2pptx library is required for HTML to PPTX conversion:

```bash
# Install html2pptx globally
npm install -g ./refactor_ideas/pptx/html2pptx.tgz

# Or use the convenience script
npm run install-html2pptx
```

### Environment Variables

Create a `.env` file:

```env
AZURE_OPENAI_ENDPOINT=your_endpoint
AZURE_OPENAI_API_KEY=your_api_key
DEFAULT_LLM_DEPLOYMENT=gpt-5
DEFAULT_LLM_TEMPERATURE=1
```

## API Usage

### Generate Presentation

**Endpoint**: `POST /generate`

**Request Body**:

```json
{
  "userName": "User Name",
  "threadId": "thread-123",
  "conversation": [
    {
      "index": 0,
      "question": {"content": "What are the key findings?"},
      "answer": {"content": "The analysis shows..."}
    }
  ],
  "assets": {
    "indicatorCharts": [
      {
        "title": "Chart Title",
        "encodedImage": "base64_encoded_image_data"
      }
    ],
    "sourceList": [
      {
        "title": "Source Title",
        "link": "https://example.com"
      }
    ]
  }
}
```

**Response**:

```json
{
  "fileId": "20241021-question_title-thread-123.pptx"
}
```

## Project Structure

```
Core-PPTAutomate/
├── src/
│   ├── api/
│   │   ├── routes_generate.py      # API endpoint
│   │   └── generate_schema.py      # Request schemas
│   ├── services/
│   │   ├── content_parser.py       # Parse conversation data
│   │   ├── html_slide_generator.py # Generate HTML slides
│   │   ├── pptx_converter.py       # Convert HTML to PPTX
│   │   ├── file_saver.py           # Save output files
│   │   └── llm.py                  # LLM client
│   ├── workflows/
│   │   └── presentation_workflow.py # Main workflow orchestration
│   ├── prompts/
│   │   └── html_slide_generator.py  # Prompt templates
│   └── logging.py                   # Logging configuration
├── resources/                       # (deprecated templates)
├── refactor_ideas/pptx/            # html2pptx library and docs
├── output/                          # Generated presentations
├── workspace/                       # Temporary working files
├── requirements.txt
├── package.json
└── app.py                           # FastAPI application
```

## Development

### Run Server

```bash
# Development mode
uvicorn app:app --reload --port 5056

# Production mode
gunicorn -k uvicorn.workers.UvicornWorker app:app --bind=0.0.0.0:5056
```

### Docker

```bash
docker build -t ppt-automate .
docker run -p 5056:5056 --env-file .env ppt-automate
```

## Design Guidelines

Following claude-skills/pptx best practices:

### Colors

- Select 3-5 colors that match content theme
- Ensure strong contrast (WCAG AA minimum)
- Use hex colors with `#` prefix in CSS
- **Never use `#` prefix in PptxGenJS** (causes corruption)

### Fonts

**Web-safe fonts only**:
- Arial, Helvetica, Times New Roman, Georgia
- Courier New, Verdana, Tahoma, Trebuchet MS, Impact

### Layouts

- Standard: 720pt × 405pt (16:9)
- Use flexbox for responsive layouts
- Two-column preferred for chart slides
- Never vertically stack charts below text

### HTML Rules

**Critical**:
- ALL text must be in `<p>`, `<h1>`-`<h6>`, `<ul>`, `<ol>` tags
- Never use manual bullet symbols (•, -, *)
- No CSS gradients (use solid colors or pre-rendered PNGs)
- No SVG or canvas elements
- Backgrounds/borders/shadows only on `<div>` elements

## Workflow Details

### 1. Content Parsing

`ContentParser` analyzes conversation data:
- Extracts questions and answers
- Organizes into slide structure
- Processes chart metadata
- Handles source references

### 2. HTML Generation

`HTMLSlideGenerator` creates slides:
- Title slide with gradient background
- Content slides generated by LLM
- Chart placeholder divs
- Sources/references slide

### 3. PPTX Conversion

`PPTXConverter` uses Node.js:
- Creates conversion script dynamically
- Runs html2pptx on each slide
- Adds charts to placeholders
- Outputs final PPTX file

## License

Proprietary
